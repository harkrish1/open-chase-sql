{
    "question_id": 84,
    "question": "What are the two most common first names among the school administrators? Indicate the district to which they administer.",
    "db_id": "california_schools",
    "SQL": "SELECT DISTINCT T1.AdmFName1, T1.District FROM schools AS T1 INNER JOIN ( SELECT admfname1 FROM schools GROUP BY admfname1 ORDER BY COUNT(admfname1) DESC LIMIT 2 ) AS T2 ON T1.AdmFName1 = T2.admfname1",
    "expert_result": "    AdmFName1                            District\n0       David  Alameda County Office of Education\n1       David                     Fremont Unified\n2       David                     Hayward Unified\n3       David                     Oakland Unified\n4       David                       Chico Unified\n..        ...                                 ...\n210   Michael                     Visalia Unified\n211   Michael                      Dinuba Unified\n212   Michael                 Simi Valley Unified\n213   Michael                     Ventura Unified\n214   Michael               Conejo Valley Unified\n\n[215 rows x 2 columns]",
    "generated_result": "    AdmFName1                            District\n0       David  Alameda County Office of Education\n1       David                     Fremont Unified\n2       David                     Hayward Unified\n3       David                     Oakland Unified\n4       David                       Chico Unified\n..        ...                                 ...\n210   Michael                     Visalia Unified\n211   Michael                      Dinuba Unified\n212   Michael                 Simi Valley Unified\n213   Michael                     Ventura Unified\n214   Michael               Conejo Valley Unified\n\n[215 rows x 2 columns]",
    "generated_sql": "WITH name_counts AS (\n  SELECT AdmFName1, COUNT(*) AS cnt\n  FROM schools\n  WHERE AdmFName1 IS NOT NULL\n  GROUP BY AdmFName1\n  ORDER BY cnt DESC\n  LIMIT 2\n)\nSELECT DISTINCT s.AdmFName1, s.District\nFROM schools AS s\nJOIN name_counts AS nc\n  ON s.AdmFName1 = nc.AdmFName1\nWHERE s.District IS NOT NULL;"
}

{
    "question_id": 17,
    "question": "Rank schools by their average score in Writing where the score is greater than 499, showing their charter numbers.",
    "db_id": "california_schools",
    "SQL": "SELECT CharterNum, AvgScrWrite, RANK() OVER (ORDER BY AvgScrWrite DESC) AS WritingScoreRank FROM schools AS T1  INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.AvgScrWrite > 499 AND CharterNum is not null",
    "expert_result": "   CharterNum  AvgScrWrite  WritingScoreRank\n0        0210          630                 1\n1        0890          593                 2\n2        0290          582                 3\n3        0930          579                 4\n4        1169          576                 5\n5        1079          558                 6\n6        0120          555                 7\n7        0747          554                 8\n8        0612          551                 9\n9        0759          548                10\n10       1071          547                11\n11       0572          543                12\n12       0658          542                13\n13       0271          540                14\n14       0284          539                15\n15       1070          538                16\n16       0844          537                17\n17       0180          535                18\n18       1398          535                18\n19       0248          533                20\n20       0056          533                20\n21       0050          531                22\n22       0084          530                23\n23       0419          529                24\n24       0147          528                25\n25       0588          526                26\n26       0037          525                27\n27       1580          524                28\n28       0019          524                28\n29       0835          522                30\n30       0838          521                31\n31       0169          520                32\n32       1083          519                33\n33       0267          517                34\n34       0493          517                34\n35       1314          514                36\n36       0109          513                37\n37       0664          512                38\n38       0756          511                39\n39       1571          509                40\n40       0537          508                41\n41       1427          508                41\n42       0579          506                43\n43       0512          506                43\n44       0127          505                45\n45       0477          504                46\n46       0730          503                47\n47       0565          503                47\n48       0332          502                49\n49       1208          502                49",
    "generated_result": "   CharterNum  AvgScrWrite\n0        0210          630\n1        0890          593\n2        0290          582\n3        0930          579\n4        1169          576\n5        1079          558\n6        0120          555\n7        0747          554\n8        0612          551\n9        0759          548\n10       1071          547\n11       0572          543\n12       0658          542\n13       0271          540\n14       0284          539\n15       1070          538\n16       0844          537\n17       0180          535\n18       1398          535\n19       0248          533\n20       0056          533\n21       0050          531\n22       0084          530\n23       0419          529\n24       0147          528\n25       0588          526\n26       0037          525\n27       1580          524\n28       0019          524\n29       0835          522\n30       0838          521\n31       0169          520\n32       1083          519\n33       0267          517\n34       0493          517\n35       1314          514\n36       0109          513\n37       0664          512\n38       0756          511\n39       1571          509\n40       0537          508\n41       1427          508\n42       0579          506\n43       0512          506\n44       0127          505\n45       0477          504\n46       0730          503\n47       0565          503\n48       0332          502\n49       1208          502",
    "generated_sql": "SELECT s.CharterNum, ss.AvgScrWrite\nFROM schools AS s\nJOIN satscores AS ss\n  ON s.CDSCode = ss.cds\nWHERE ss.AvgScrWrite > 499\n  AND s.CharterNum IS NOT NULL\nORDER BY ss.AvgScrWrite DESC;"
}
